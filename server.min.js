function get_ip_config(){Object.keys(ifaces).forEach(function(t){var e=0;ifaces[t].forEach(function(t){return"IPv4"===t.family&&t.internal===!1?e>=1?t.address:t.address:void 0})})}var express=require("express"),app=express(),router=express.Router(),path=require("path"),users=[],server=null,http=require("http").Server(app),port=3e3,os=require("os"),ifaces=os.networkInterfaces(),ip_config=get_ip_config(),io=require("socket.io")(http),_=require("underscore"),cp=require("child_process");$=require("jquery"),app.use("/",router),app.use(function(t,e){console.log(e),e.send(404)}),module.exports=router,app.use(express["static"]("./src")),app.get("*",function(t,e){console.log(t," ::: ",e),e.sendFile("njoy/src/index.html",{root:path.join(__dirname,"../")})}),app.listen(port,function(){console.log("app start listenning ",port),cp.exec("/home/pi/startchromium.sh",function(t,e,n){console.log("stdout: "+e),console.log("stderr: "+n),null!==t&&console.log("exec errror: "+t)})}),io.on("connection",function(t){console.log("a user connected"),t.on("disconnect",function(){console.log("user disconnected")}),t.on("njoy",function(t){users_activities.push(t),t=addParams(t);var e={},n="njoy";switch(t.status){case"connect":e=login(t),t=addParams(t),io.emit("njoy_"+t.uuid,{status:e.status,infos:e,datas:t}),n="njoy";break;case"disconnect":e=logout(t),t=addParams(t);break;case"activities":e.status="activities",t.users_activities=users_activities;break;case"message":e.status="message";break;case"launch_content":e.status="launch_content";break;default:e={status:"default"}}console.log("call ::: ",n," stat ",e),io.emit(n,{status:e.status,infos:e,datas:t})})}),http.listen(3007,function(){});var login=function(t){return"undefined"==typeof users&&(users=[]),_.where(users,{user_name:t.user_name}).length>0?{status:"login_error",message:"need uniq pseudo"}:(users.push({user_name:t.user_name,uuid:t.uuid}),0===_.where(users,{regis:"true"}).length&&(users[users.length-1].regis="true"),{status:"login_success",message:"success login",users:users})},logout=function(t){return require("underscore"),users=_.without(users,_.findWhere(users,{uuid:t.uuid})),{status:"logout_success",message:"success lougout"}},addParams=function(t){return"undefined"==typeof t&&(t={}),t.users=users,t.animations=animations,t.ip_config=get_ip_config(),t},users_activities=[],animations=null;