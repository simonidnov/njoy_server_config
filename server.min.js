function get_ip_config(){Object.keys(ifaces).forEach(function(e){var t=0;ifaces[e].forEach(function(e){return"IPv4"===e.family&&e.internal===!1?t>=1?e.address:e.address:void 0})})}var express=require("express"),app=express(),router=express.Router(),path=require("path"),users=[],server=null,http=require("http").Server(app),port=8080,os=require("os"),ifaces=os.networkInterfaces(),ip_config=get_ip_config(),io=require("socket.io")(http),_=require("underscore"),cp=require("child_process");$=require("jquery"),module.exports=router,app.use(express["static"]("./src")),app.get("*",function(e,t){console.log(e," ::: ",t),t.sendFile("njoy/src/index.html",{root:path.join(__dirname,"../")})}),app.listen(port,function(){console.log("app start listenning ",port),cp.exec("chromium-browser --noerrdialogs --disable-session-crashed-bubble --disable-infobars --kiosk --force-gpu-rasterization http://10.3.141.1:3000/receptor",function(e,t,s){console.log("stdout: "+t),console.log("stderr: "+s),null!==e&&console.log("exec errror: "+e)})}),io.on("connection",function(e){console.log("a user connected"),e.on("disconnect",function(){console.log("user disconnected")}),e.on("njoy",function(e){users_activities.push(e),e=addParams(e);var t={},s="njoy";switch(e.status){case"connect":t=login(e),e=addParams(e),io.emit("njoy_"+e.uuid,{status:t.status,infos:t,datas:e}),s="njoy";break;case"disconnect":t=logout(e),e=addParams(e);break;case"activities":t.status="activities",e.users_activities=users_activities;break;case"message":t.status="message";break;case"launch_content":t.status="launch_content",console.log(e);break;default:t={status:"default"}}console.log("call ::: ",s," stat ",t),io.emit(s,{status:t.status,infos:t,datas:e})})}),http.listen(3e3,function(){console.log("listening on *:3000")});var login=function(e){return"undefined"==typeof users&&(users=[]),_.where(users,{user_name:e.user_name}).length>0?{status:"login_error",message:"need uniq pseudo"}:(users.push({user_name:e.user_name,uuid:e.uuid}),0===_.where(users,{regis:"true"}).length&&(users[users.length-1].regis="true"),{status:"login_success",message:"success login",users:users})},logout=function(e){return require("underscore"),users=_.without(users,_.findWhere(users,{uuid:e.uuid})),{status:"logout_success",message:"success lougout"}},addParams=function(e){return"undefined"==typeof e&&(e={}),e.users=users,e.animations=animations,e.ip_config=get_ip_config(),e},users_activities=[],animations=null;