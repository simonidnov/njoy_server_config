var receptor={currentShape:[],canvas:null,init:function(){app.init(function(){}),app.socket_callback=$.proxy(function(e){"undefined"!=typeof e.datas&&this.create_component(e.datas)},this)},create_component:function(e){switch(e.status){case"init_drawing":$(".module").html(""),$(".chronos").remove(),TweenMax.killAll(),this.init_drawing(e);break;case"drawing":this.drawing(e);break;case"drawing_point":this.drawing_point(e);break;case"video":$(".module").html(""),$(".chronos").remove(),TweenMax.killAll(),$(".module").append('<div class="video_display"><video src="'+window.location.origin+"/"+e.file+'" autoplay width="'+window.innerWidth+'px" height="'+window.innerHeight+'px"></video></div>');break;case"playlist_video":$(".module").append('<div class="video_display"></div>'),TweenMax.killAll(),console.log("play video playlist");break;case"audio":TweenMax.killAll(),"undefined"!=typeof this.audio&&this.audio.pause(),this.audio=new Audio(e.file),this.audio.play(),console.log("play audio http://10.213.1.231:3000/",e.file);break;case"playlist_audio":$(".module").append('<div class="audio_display"></div>'),TweenMax.killAll(),console.log("play audio playlist");break;case"picture":$(".module").html(""),TweenMax.killAll(),$(".module").append('<div class="picture_display"></div>'),$(".picture_display").css("background-image","url("+e.file+")"),console.log("display picture");break;case"":break;case"success":this.success(e),console.log("this is success");break;case"fail":this.fail(e),console.log("this is fail");break;case"object":this.object_component(e);break;case"golden_family":this.golden_family(e);break;case"web_content":this.web_content(e)}"undefined"!=typeof e.chronos&&this.setChronos(e.chronos,e.chronos_type)},web_content:function(e){console.log(e)},object_component:function(e){switch($(".module").html(""),$(".chronos").remove(),TweenMax.killAll(),e.component){case"quiz_component":break;case"golden_family":$(".module").append('<div class="golden_family"><div class="content_choice"><h3>'+e.tools.menu[e.menu].components.golden_family[e.component_id].desc+'</h3><ul class="choices"></ul></div></div>');for(var s=e.tools.menu[e.menu].components.golden_family[e.component_id].choices.length,t=0;s>t;t++)$(".receptor .module .golden_family ul.choices").append('<li><div class="front"></div><div class="back">'+e.tools.menu[e.menu].components.golden_family[e.component_id].choices[t]+'<div class="points">'+(10*s-10*t)+"</div></div></li>")}},golden_family:function(e){"undefined"!=typeof e.response&&$(".receptor .module .golden_family ul.choices li").eq(parseInt(e.response)).addClass("selected")},setChronos:function(e,s){"undefined"==typeof s&&(s="bottom"),$(".screen.receptor").append('<div class="chronos '+s+'"><div class="counter"></div><div class="timelap"><div class="progress"></div></div></div>'),$(".chronos .counter").html(e);var t=TweenMax.to($(".timelap .progress"),parseInt(e),{css:{width:"100%"},ease:Linear.easeNone,onUpdate:function(s){$(".chronos .counter").html(parseInt(e)-Math.round(t.time()))},onComplete:function(){}})},success:function(){0==$(".motion_canvas").length&&$(".module").append('<canvas class="motion_canvas" id="motion_canvas"></canvas'),"undefined"!=typeof this.conf&&delete this.conf,this.conf=new confettis,this.conf.initConfettis("motion_canvas"),this.conf.start_confettis(),setTimeout($.proxy(function(){this.conf.stop_confettis()},this),1e3)},fail:function(){$(".module").append('<canvas class="motion_canvas" id="motion_canvas"></canvas')},init_drawing:function(e){console.log("init_drawing"),$(".module").append('<canvas id="drawing" width="'+e.width+'" height="'+e.height+'"></canvas>'),this.canvas=document.getElementById("drawing"),this.canvas.width=e.width,this.canvas.height=e.height,this.canvas.style.width=window.innerWidth,this.canvas.style.height=window.innerHeight,$("#canvas_id").css({width:$("body").width()+"px !important",height:$("body").height()+"px !important"}),this.stage=new createjs.Stage("drawing"),this.stage.autoClear=!0,this.stage.update(),this.currentShape=[];var s=new createjs.Shape;this.currentShape[0]=s;var t=s.graphics;t.beginStroke("#000000"),this.stage.addChild(s),this.stage.autoClear=!0,this.stage.update()},drawing_point:function(e){console.log("drawing_point with new shape then set oldX Y enstroke",e.x),this.oldX=e.x,this.oldY=e.y,this.currentShape[this.currentShape.length-1].graphics.endStroke().endFill();var s=new createjs.Shape;this.currentShape[this.currentShape.length]=s;var t=s.graphics;t.beginStroke("#000000"),this.stage.addChild(s),t.moveTo(e.x,e.y)},drawing:function(e){console.log(this.oldX);var s=new createjs.Point(e.x,e.y),t=new createjs.Point(this.oldX+s.x>>1,this.oldY+s.y>>1);"undefined"!=typeof this.currentShape[this.currentShape.length-1]&&(this.currentShape[this.currentShape.length-1].graphics.setStrokeStyle(e.strokestyle.size,e.strokestyle.stylingW,e.strokestyle.stylingH),this.currentShape[this.currentShape.length-1].graphics.moveTo(t.x,t.y),this.currentShape[this.currentShape.length-1].graphics.curveTo(this.oldX,this.oldY,this.oldMidX,this.oldMidY)),this.oldX=s.x,this.oldY=s.y,this.oldMidX=t.x,this.oldMidY=t.y,this.stage.update()},destroy:function(){console.log("destroy receptor")}},drawer=function(e,s,t){this.canvas=document.getElementById(e),this.canvas.width=s,this.canvas.height=t,this.canvas.style.width=s,this.canvas.style.height=t,$("#canvas_id").css({width:$("body").width()+"px !important",height:$("body").height()+"px !important"}),this.stage=new createjs.Stage(e),this.stage.autoClear=!0,this.stage.update(),this.currentShape=[];var n=new createjs.Shape;this.currentShape[0]=n;var i=n.graphics;i.beginStroke("#000000"),this.stage.addChild(n)};