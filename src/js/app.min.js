var app={infos:{user_name:"",uuid:"",regis:false,users:[]},activities:null,ip:"http://192.168.0.10:3000",callback:null,socket:null,init:function(a){this.get_activities();this.callback=a;this.init_socket()},get_activities:function(){$.getJSON("activities.json",function(a){app.activities=a;console.log("activities ::: ",a)})},check_server:function(){},init_socket:function(){this.ip=window.location.origin;app.infos.uuid=new Date().getTime();app.socket_callback=function(a){console.log(a)};app.socket=io(this.ip,{transports:["websocket","xhr-polling"]});app.socket.on("error",function(a){console.log("error");app.callback({status:"error_socket",datas:a})});app.socket.on("connect_failed",function(a){console.log("connect_failed");app.callback({status:"connect_failed"})});app.socket.on("connect",function(a){console.log("user connected ",a);app.callback({status:"socket_connected"})});app.socket.on("njoy",function(a){console.log("njoy : ",a);switch(a.status){case"activities":app.infos.activities=a.activities;break;default:break}app.socket_callback(a)});app.socket.on("njoy_"+app.infos.uuid,function(a){console.log("login_success ",a);switch(a.status){case"animations":break;case"login_success":console.log("datas.datas.users ",a.datas.users);app.infos.users=a.datas.users;console.log("_.where(app.infos.users, {uuid:app.infos.uuid})[0].regis ",_.where(app.infos.users,{uuid:app.infos.uuid})[0].regis);if(_.where(app.infos.users,{uuid:app.infos.uuid})[0].regis!=="undefined"&&_.where(app.infos.users,{uuid:app.infos.uuid})[0].regis==="true"){app.infos.regis=true}break;case"login_error":app.infos.users=a.datas.users;break;default:break}if(typeof a.datas.animations!=="undefined"){animations=a.datas.animations}app.socket_callback(a)});app.socket.emit("njoy",{status:"new"});app.socket.on("chat_message",function(a){$("#messages").append($("<li>").text(JSON.stringify(a)))});window.onbeforeunload=function(a){app.socket.emit("njoy",{status:"disconnect",user_name:app.infos.user_name,uuid:app.infos.uuid})}},destroy:function(){}};